<!DOCTYPE html>
<html lang="en">

<head>
    <%- include("partials/head") %>
        <title>Home</title>
</head>

<body>
    <%- include("partials/nav") %>
        <div class="max-w-5xl mx-auto bg-gray-200 mt-3 p-4 shadow rounded text-left">
            <h1 class="text-3xl font-bold mt-7 mb-8 text-gray-700">
                Title : <%= blog.title %>
            </h1>
            <img src="<%= blog.coverImage || '/default-image.png' %>" class="w-full rounded mb-6 mx-auto" />
            <h3 class="text-xl ml-0 font-bold mb-4 text-gray-700">
                Description : <%= blog.description %>
            </h3>
            <p class="text-xl mt-4 mb-4 text-gray-700">
                Content : <%= blog.body %>
            </p>
            <h5 class="text-xl ml-0 font-bold mb-4 text-gray-700">Author: <%=blog.author.fullname %>
            </h5>
            <p class="text-xl mt-4 mb-4 text-gray-700">Uploaded at : <%=blog.author.createdAt %>
            </p>
            <h6 class="text-xl mt-4 mb-4 font-bold text-gray-700">Comments( <%= blog.comments ? blog.comments.length : 0
                    %>)</h6>
            <div>
                <% if (blog.comments && blog.comments.length> 0) { %>
                    <% blog.comments.forEach(comment=> { %>
                        <div class="comment-item mb-3 p-2 border rounded">
                            <img src="<%= comment.commentUser.profileImageUrl %>" alt="User Image"
                                class="w-8 h-8 rounded-full inline-block mr-2" />
                            <strong>
                                <%= comment.commentUser.fullname %>
                            </strong>
                            <p>
                                <%= comment.commentBody %>
                            </p>
                            <small>
                                <%= new Date(comment.createdAt).toLocaleString() %>
                            </small>
                        </div>
                        <% }) %>
                            <% } else { %>
                                <p class="mt-2 mb-2">No comments yet. Be the first to comment!</p>
                                <% } %>
            </div>
            <div class="flex items-start justify-start gap-4">
                <% if (user) { %>
                    <form class="flex justify-start gap-3 w-full max-w-xxl" method="post" action="/comment/addComments">
                        <img src="<%= user.profileImageUrl %>" alt="User Profile" class="w-10 h-10 rounded-full" />
                        <input type="hidden" name="blogId" value="<%= blog._id %>">
                        <input type="text" name="commentBody" id="commentBody" placeholder="Leave a comment" required
                            class="flex-grow bg-white border border-gray-800 text-black placeholder-black text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 p-2.5" />
                        <button type="submit"
                            class="px-4 py-2 text-sm font-medium text-white bg-blue-500 rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-200 dark:focus:ring-blue-900">
                            Add Comment
                        </button>
                    </form>
                    <% } else { %>
                        <p class="text-gray-600 italic">Please <a href="/login" class="text-blue-500 underline">log
                                in</a> to leave a comment.</p>
                        <% } %>
            </div>


        </div>

        <%- include("partials/scripts") %>
</body>

</html>